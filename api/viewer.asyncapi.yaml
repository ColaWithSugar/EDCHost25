asyncapi: '2.6.0'
info:
  title: EDCHost Viewer API
  version: '0.1.0'
channels: 
  viewer:
    subscribe:
      message:
        name: GameInfo
        payload:
          type: object
          additionalProperties: false
          properties:
            cameras:
              type: array
              items:
                type: object
                additionalProperties: false
                properties:
                  cameraId:
                    type: integer
                    description: |
                      The camera id.
                  frameData:
                    type: string
                    format: binary
                    description: |
                      The frame.
                  frameRate:
                    type: number
                    description: |
                      The frame rate.
            elapsedTime:
              type: integer
              description: |
                The elapsed time.
            events:
              type: array
              items:
                oneOf:
                  - type: object
                    additionalProperties: false
                    properties: 
                      eventType:
                        type: string
                        const: PLAYER_ATTACK
                      playerId:
                        type: integer
                        description: |
                          The player id.
                      targetPlayerId:
                        type: integer
                        description: |
                          The target player id.
                  - type: object
                    additionalProperties: false
                    properties:
                      eventType:
                        type: string
                        const: PLAYER_BE_HURT
                      playerId:
                        type: integer
                        description: |
                          The player id.
                      damage:
                        type: integer
                        description: |
                          The damage.
                  - type: object
                    additionalProperties: false
                    properties:
                      eventType:
                        type: string
                        const: PLAYER_PICK_UP
                      playerId:
                        type: integer
                        description: |
                          The player id.
                      mineType:
                        type: string
                        description: |
                          The mine type.
                        enum:
                          - IRON_INGOT
                          - GOLD_INGOT
                          - DIAMOND
                      mineCount:
                        type: integer
                        description: |
                          The mine count.
                      equivalentEmeraldCount:
                        type: integer
                        description: |
                          The equivalent emerald count.
                  - type: object
                    additionalProperties: false
                    properties:
                      eventType:
                        type: string
                        const: PLAYER_DIG
                      playerId:
                        type: integer
                        description: |
                          The player id.
                      targetChunk:
                        type: integer
                        description: |
                          The target chunk.
                      
            gameStage:
              type: string
              description: |
                The game stage
              enum:
                - READY
                - RUNNING
                - BATTLING
                - FINISHED
            heightOfChunks:
              type: array
              items:
                type: integer
                minItems: 64
                maxItems: 64
                description: |
                  The height of chunks.
            mines:
              type: array
              items:
                type: object
                additionalProperties: false
                properties:
                  accumulatedCount:
                    type: integer
                    description: |
                      The accumulated count.  
                  mineType:
                    type: string
                    description: |
                      The mine type.
                    enum:
                      - IRON_INGOT
                      - GOLD_INGOT
                      - DIAMOND
                  position:
                    type: object
                    additionalProperties: false
                    properties:
                      x:
                        type: number
                        description: |
                          The x coordinate.
                      y:
                        type: number
                        description: |
                          The y coordinate.
            players:
              type: array
              items:
                type: object
                additionalProperties: false
                properties:
                  playerId:
                    type: integer
                    description: |
                      The player id.
                  homePosition:
                    type: object
                    additionalProperties: false
                    properties:
                      x:
                        type: number
                        description: |
                          The x coordinate.
                      y:
                        type: number
                        description: |
                          The y coordinate.
                  position:
                    type: object
                    additionalProperties: false
                    properties:
                      x:
                        type: number
                        description: |
                          The x coordinate.
                      y:
                        type: number
                        description: |
                          The y coordinate.
                  agility:
                    type: integer
                    description: |
                      The agility point.
                  health:
                    type: integer
                    description: |
                      The health point.
                  maxHealth:
                    type: integer
                    description: |
                      The max health point.
                  strength:
                    type: integer
                    description: |
                      The strength point.
                  hasBed:
                    type: boolean
                    description: |
                      Whether the player has bed.
                  emeraldCount:
                    type: integer
                    description: |
                      The emerald count.
                  woolCount:
                    type: integer
                    format: int8
                    description: |
                      The wool count.
    publish:
      message:
        oneOf:
          - name: Configuration
            payload:
              type: object
              additionalProperties: false
              properties:
                cameras:
                  type: array
                  items:
                    type: object
                    additionalProperties: false
                    properties:
                      calibrationPoints:
                        type: array
                        description: |
                          The calibration.
                        minItems: 4
                        maxItems: 4
                        items:
                          type: object
                          additionalProperties: false
                          properties:
                            x:
                              type: number
                              description: |
                                The x coordinate.
                            y:
                              type: number
                              description: |
                                The y coordinate.
                      cameraId:
                        type: integer
                        description: |
                          The camera id.
                      recognition:
                        type: object
                        additionalProperties: false
                        properties:
                          hueCenter:
                            type: number
                            description: |
                              The hue center.
                          hueRange:
                            type: number
                            description: |
                              The hue range.
                          saturationCenter:
                            type: number
                            description: |
                              The saturation center.
                          saturationRange:
                            type: number
                            description: |
                              The saturation range.
                          valueCenter:
                            type: number
                            description: |
                              The value center.
                          valueRange:
                            type: number
                            description: |
                              The value range.
                          minArea:
                            type: number
                            description: |
                              The min area.
                          showMask:
                            type: boolean
                            description: |
                              Whether to show mask.
                players:
                  type: array
                  items:
                    additionalProperties: false
                    properties:
                      baudRate:
                        type: integer
                        description: |
                          The baud rate.
                      cameraId:
                        type: integer
                        description: |
                          The camera id.
                      playerId:
                        type: integer
                        description: |
                          The player id.
                      serialPort:
                        type: string
                        description: |
                          The serial port.  
          - name: Control
            payload:
              type: object
              additionalProperties: false
              properties:
                command:
                  type: string
                  enum:
                    - START
                    - END
                    - RESET
